# Advanced DOM and Events in [[JavaScript]]
## How the DOM really works
![[Screenshot 2022-08-12 at 17.27.58.png]]

![[Screenshot 2022-08-12 at 17.38.00.png]]

## Selecting, Creating and Deleting Elements
### Selecting Elements
![[Screenshot 2022-08-12 at 17.47.58.png]]
![[Screenshot 2022-08-12 at 17.48.15.png]]
![[Screenshot 2022-08-12 at 17.56.10.png]]

### Creating and Inserting Elements
![[Screenshot 2022-08-12 at 18.09.38.png]]
![[Screenshot 2022-08-12 at 18.10.09.png]]

![[Screenshot 2022-08-12 at 18.11.45.png]]
![[Screenshot 2022-08-12 at 18.11.59.png]]

![[Screenshot 2022-08-12 at 18.14.54.png]]
![[Screenshot 2022-08-12 at 18.15.43.png]]

### Deleting Elements
![[Screenshot 2022-08-12 at 18.18.22.png]]

## Styles, Attributes and Classes
### Styles
Adding styles with JavaScript creates inline styles.
![[Screenshot 2022-08-12 at 23.14.28.png]]

Retreiving styles
![[Screenshot 2022-08-12 at 23.18.32.png]]
![[Screenshot 2022-08-12 at 23.20.19.png]]
![[Screenshot 2022-08-12 at 23.20.36.png]]

Adding using JS to add height (or any value) to a CSS property.
![[Screenshot 2022-08-12 at 23.24.25.png]]

Working with CSS variables (custom properties)
![[Screenshot 2022-08-12 at 23.28.16.png]]

### Attributes
![[Screenshot 2022-08-12 at 23.32.07.png]]
![[Screenshot 2022-08-12 at 23.32.22.png]]

Getting non standard HTML attributes
![[Screenshot 2022-08-12 at 23.34.36.png]]
![[Screenshot 2022-08-12 at 23.35.13.png]]![[Screenshot 2022-08-12 at 23.35.42.png]]

### Classes
![[Screenshot 2022-08-12 at 23.45.09.png]]


## Types of Events and Handlers
An event is basically a signal (something that has happened) that is generated by a certain DOM node. - Eg. A click, mouse moving or keyboard press.
We then listen for these events using event handlers.

JavaScript event references MDN: https://developer.mozilla.org/en-US/docs/Web/Events#event_index

Removing event listeners:
![[Screenshot 2022-08-13 at 15.36.57.png]]

## Event Propagation: Bubbling and Capturing
JavaScript events have a capturing phase and bubbling phase.

![[Screenshot 2022-08-15 at 18.51.06.png]]

## Event Delegation: Implementing Page Navigation (smooth scroll)
Here's an example of implementing smooth scroll with JavaScript without event delegation on some nav links that point to different sections of the page:

![[Screenshot 2022-08-16 at 14.57.06.png]]

The problem with this is that we are effectively attaching the same callback function on every nav link element because we are using the forEach method. Not a problem for a small number of elements but if we scale to say a thousand links, it wouldn't be very efficient.

We can solve this with event delegation. In this, we use the fact that events 'bubble up'. We do this by putting the event listener on a common parent of all the elements we are interested in (for example a container containing all the links).

1. Add event listenener to common parent element
2. Determine what element originated the event (the target)

Here's the example from before but with event delegation:

![[Screenshot 2022-08-16 at 15.10.51.png]]

Another important use case is when we are working with elements that are not yet on the page on runtime (by the time the page loads). An example of this is buttons that are added dynamically while using the app. It is not possible to add event handlers onto elements that do not yet exist, but we can still handle events on elements that don't exist yet by using event delegation.

## DOM Traversing
DOM travsersing is basically 'walking' through the DOM, which means we can select an element based on another element. This is important because sometimes we need to select elements relative to a certain other element, for example, a direct child or a direct parent element.

Here's some examples:

![[Screenshot 2022-08-16 at 16.16.23.png]]

Travsering down:

![[Screenshot 2022-08-16 at 16.24.13.png]]
![[Screenshot 2022-08-16 at 16.24.41.png]]
Traversing upwards:

![[Screenshot 2022-08-16 at 16.31.41.png]]

![[Screenshot 2022-08-16 at 16.31.55.png]]
Traversing sideways:

![[Screenshot 2022-08-16 at 16.43.08.png]]

![[Screenshot 2022-08-16 at 16.43.20.png]]

## The Intersection Observer API
Allows our code to 'observe' changes to the way a certain target element intersects another element, or the way it intersects the viewport. Useful for implementing sticky navigation.

![[Screenshot 2022-08-23 at 12.46.39.png]]

The root is the 'other element' on which the target element intersects. In this case the root set to null is the viewport. 

The threshold is the percentage of the target element that needs to be intersecting for the callback function to be called. In this case, 10% of the section1 element needs to be visible in the viewport for the callback to be called.

![[Screenshot 2022-08-23 at 12.50.31.png]]

We get the isIntersecting as false when less than 10% is visible (or intersecting), and viceversa for the second log. (notice the intersectionRatio).

Using this to create a sticky nav:

![[Screenshot 2022-08-23 at 13.05.56.png]]

Improving this to make the nav appear before the threshold is met by using the rootMargin:

![[Screenshot 2022-08-23 at 13.10.04.png]]

![[Screen Recording 2022-08-23 at 13.10.40.mov]]

One last improvement to make the height on the rootMargin dynamic:

![[Screenshot 2022-08-23 at 13.15.04.png]]
